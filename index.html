<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng K·∫ø To√°n</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <i class="fas fa-chart-line"></i>
            <h2>H·ªá Th·ªëng K·∫ø To√°n</h2>
        </div>
        <nav class="menu">
            <a href="#" class="menu-item active" onclick="showSection('dashboard')">
                <i class="fas fa-home"></i>
                <span>T·ªïng Quan</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('receipt')">
                <i class="fas fa-hand-holding-usd"></i>
                <span>Phi·∫øu Thu</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('payment')">
                <i class="fas fa-money-bill-wave"></i>
                <span>Phi·∫øu Chi</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('invoice')">
                <i class="fas fa-file-invoice-dollar"></i>
                <span>H√≥a ƒê∆°n</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('customer')">
                <i class="fas fa-users"></i>
                <span>Kh√°ch H√†ng</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('supplier')">
                <i class="fas fa-building"></i>
                <span>Nh√† Cung C·∫•p</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('material')">
                <i class="fas fa-boxes"></i>
                <span>Nguy√™n V·∫≠t Li·ªáu</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('opening')">
                <i class="fas fa-wallet"></i>
                <span>S·ªë D∆∞ ƒê·∫ßu K·ª≥</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('employee')">
                <span>ÔøΩ‚Äçüíºp</span> Nh√¢n Vi√™n
            </a>
            <a href="#" class="menu-item" onclick="showSection('attendance')">
                <i class="fas fa-clock"></i>
                <span>Ch·∫•m C√¥ng</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('accounting')">
                <i class="fas fa-book"></i>
                <span>H·∫°ch To√°n</span>
            </a>
            <a href="#" class="menu-item" onclick="showSection('report')">
                <span>üìà</span> B√°o C√°o
            </a>
            <a href="#" class="menu-item" onclick="showSection('settings')">
                <span>‚öôÔ∏è</span> C√†i ƒê·∫∑t
            </a>
        </nav>
    </div>

    <div class="main-content">
        <!-- Dashboard -->
        <div id="dashboard" class="section active">
            <h1>T·ªïng Quan T√†i Ch√≠nh</h1>
            <div class="stats-grid">
                <div class="stat-card revenue">
                    <div class="stat-icon">
                        <i class="fas fa-arrow-trend-up"></i>
                    </div>
                    <div class="stat-info">
                        <h3>T·ªïng Thu</h3>
                        <p class="stat-value" id="totalRevenue">0 ƒë</p>
                    </div>
                </div>
                <div class="stat-card expense">
                    <div class="stat-icon">
                        <i class="fas fa-arrow-trend-down"></i>
                    </div>
                    <div class="stat-info">
                        <h3>T·ªïng Chi</h3>
                        <p class="stat-value" id="totalExpense">0 ƒë</p>
                    </div>
                </div>
                <div class="stat-card profit">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-info">
                        <h3>L·ª£i Nhu·∫≠n</h3>
                        <p class="stat-value" id="totalProfit">0 ƒë</p>
                    </div>
                </div>
                <div class="stat-card balance">
                    <div class="stat-icon">
                        <i class="fas fa-piggy-bank"></i>
                    </div>
                    <div class="stat-info">
                        <h3>S·ªë D∆∞</h3>
                        <p class="stat-value" id="currentBalance">0 ƒë</p>
                    </div>
                </div>
            </div>

            <div class="recent-transactions">
                <h2>Giao D·ªãch G·∫ßn ƒê√¢y</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Ng√†y</th>
                            <th>Lo·∫°i</th>
                            <th>M√¥ T·∫£</th>
                            <th>S·ªë Ti·ªÅn</th>
                        </tr>
                    </thead>
                    <tbody id="recentTransactions"></tbody>
                </table>
            </div>
        </div>

        <!-- Phi·∫øu Thu -->
        <div id="receipt" class="section">
            <h1>Phi·∫øu Thu</h1>
            <div class="form-card">
                <form id="receiptForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>M√£ Phi·∫øu Thu *</label>
                            <input type="text" id="receiptCode" required>
                        </div>
                        <div class="form-group">
                            <label>Ng√†y Thu *</label>
                            <input type="date" id="receiptDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Kh√°ch H√†ng *</label>
                            <select id="receiptCustomer" required>
                                <option value="">Ch·ªçn kh√°ch h√†ng</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>S·ªë Ti·ªÅn *</label>
                            <input type="number" id="receiptAmount" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Di·ªÖn Gi·∫£i</label>
                        <textarea id="receiptDescription" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">L∆∞u Phi·∫øu Thu</button>
                </form>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>Danh S√°ch Phi·∫øu Thu</h2>
                    <div>
                        <button onclick="sendReportByEmail('receipts')" class="btn-export" style="background: #3498db; margin-right: 10px;">üìß G·ª≠i Email</button>
                        <button onclick="exportReceipts()" class="btn-export">Xu·∫•t Excel</button>
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>M√£ PT</th>
                            <th>Ng√†y</th>
                            <th>Kh√°ch H√†ng</th>
                            <th>S·ªë Ti·ªÅn</th>
                            <th>Di·ªÖn Gi·∫£i</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="receiptList"></tbody>
                </table>
            </div>
        </div>

        <!-- Phi·∫øu Chi -->
        <div id="payment" class="section">
            <h1>Phi·∫øu Chi</h1>
            <div class="form-card">
                <form id="paymentForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>M√£ Phi·∫øu Chi *</label>
                            <input type="text" id="paymentCode" required>
                        </div>
                        <div class="form-group">
                            <label>Ng√†y Chi *</label>
                            <input type="date" id="paymentDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nh√† Cung C·∫•p *</label>
                            <select id="paymentSupplier" required>
                                <option value="">Ch·ªçn nh√† cung c·∫•p</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>S·ªë Ti·ªÅn *</label>
                            <input type="number" id="paymentAmount" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Di·ªÖn Gi·∫£i</label>
                        <textarea id="paymentDescription" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">L∆∞u Phi·∫øu Chi</button>
                </form>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>Danh S√°ch Phi·∫øu Chi</h2>
                    <div>
                        <button onclick="sendReportByEmail('payments')" class="btn-export" style="background: #3498db; margin-right: 10px;">üìß G·ª≠i Email</button>
                        <button onclick="exportPayments()" class="btn-export">Xu·∫•t Excel</button>
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>M√£ PC</th>
                            <th>Ng√†y</th>
                            <th>Nh√† Cung C·∫•p</th>
                            <th>S·ªë Ti·ªÅn</th>
                            <th>Di·ªÖn Gi·∫£i</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="paymentList"></tbody>
                </table>
            </div>
        </div>

        <!-- H√≥a ƒê∆°n -->
        <div id="invoice" class="section">
            <h1>H√≥a ƒê∆°n B√°n H√†ng</h1>
            <div class="form-card">
                <form id="invoiceForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë H√≥a ƒê∆°n *</label>
                            <input type="text" id="invoiceNumber" required>
                        </div>
                        <div class="form-group">
                            <label>Ng√†y H√≥a ƒê∆°n *</label>
                            <input type="date" id="invoiceDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Kh√°ch H√†ng *</label>
                            <select id="invoiceCustomer" required>
                                <option value="">Ch·ªçn kh√°ch h√†ng</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>T·ªïng Ti·ªÅn *</label>
                            <input type="number" id="invoiceAmount" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>VAT (%)</label>
                            <input type="number" id="invoiceVAT" value="10">
                        </div>
                        <div class="form-group">
                            <label>Th√†nh Ti·ªÅn</label>
                            <input type="number" id="invoiceTotal" readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ghi Ch√∫</label>
                        <textarea id="invoiceNote" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">L∆∞u H√≥a ƒê∆°n</button>
                </form>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>Danh S√°ch H√≥a ƒê∆°n</h2>
                    <button onclick="exportInvoices()" class="btn-export">Xu·∫•t Excel</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>S·ªë Hƒê</th>
                            <th>Ng√†y</th>
                            <th>Kh√°ch H√†ng</th>
                            <th>T·ªïng Ti·ªÅn</th>
                            <th>VAT</th>
                            <th>Th√†nh Ti·ªÅn</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="invoiceList"></tbody>
                </table>
            </div>
        </div>

        <!-- Kh√°ch H√†ng -->
        <div id="customer" class="section">
            <h1>Qu·∫£n L√Ω Kh√°ch H√†ng</h1>
            <div class="form-card">
                <form id="customerForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>M√£ Kh√°ch H√†ng *</label>
                            <input type="text" id="customerCode" required>
                        </div>
                        <div class="form-group">
                            <label>T√™n Kh√°ch H√†ng *</label>
                            <input type="text" id="customerName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë ƒêi·ªán Tho·∫°i</label>
                            <input type="tel" id="customerPhone">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="customerEmail">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ƒê·ªãa Ch·ªâ</label>
                        <textarea id="customerAddress" rows="2"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Th√™m Kh√°ch H√†ng</button>
                </form>
            </div>

            <div class="data-table">
                <h2>Danh S√°ch Kh√°ch H√†ng</h2>
                <table>
                    <thead>
                        <tr>
                            <th>M√£ KH</th>
                            <th>T√™n Kh√°ch H√†ng</th>
                            <th>S·ªë ƒêi·ªán Tho·∫°i</th>
                            <th>Email</th>
                            <th>ƒê·ªãa Ch·ªâ</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="customerList"></tbody>
                </table>
            </div>
        </div>

        <!-- Nh√† Cung C·∫•p -->
        <div id="supplier" class="section">
            <h1>Qu·∫£n L√Ω Nh√† Cung C·∫•p</h1>
            <div class="form-card">
                <form id="supplierForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>M√£ NCC *</label>
                            <input type="text" id="supplierCode" required>
                        </div>
                        <div class="form-group">
                            <label>T√™n NCC *</label>
                            <input type="text" id="supplierName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë ƒêi·ªán Tho·∫°i</label>
                            <input type="tel" id="supplierPhone">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="supplierEmail">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ƒê·ªãa Ch·ªâ</label>
                        <textarea id="supplierAddress" rows="2"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Th√™m Nh√† Cung C·∫•p</button>
                </form>
            </div>

            <div class="data-table">
                <h2>Danh S√°ch Nh√† Cung C·∫•p</h2>
                <table>
                    <thead>
                        <tr>
                            <th>M√£ NCC</th>
                            <th>T√™n NCC</th>
                            <th>S·ªë ƒêi·ªán Tho·∫°i</th>
                            <th>Email</th>
                            <th>ƒê·ªãa Ch·ªâ</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="supplierList"></tbody>
                </table>
            </div>
        </div>

        <!-- Nguy√™n V·∫≠t Li·ªáu -->
        <div id="material" class="section">
            <h1>Qu·∫£n L√Ω Nguy√™n V·∫≠t Li·ªáu</h1>
            <div class="form-card">
                <h2>Th√™m Nguy√™n V·∫≠t Li·ªáu</h2>
                <form id="materialForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>M√£ NVL *</label>
                            <input type="text" id="materialCode" required>
                        </div>
                        <div class="form-group">
                            <label>T√™n Nguy√™n V·∫≠t Li·ªáu *</label>
                            <input type="text" id="materialName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ƒê∆°n V·ªã T√≠nh *</label>
                            <input type="text" id="materialUnit" placeholder="VD: kg, c√°i, th√πng..." required>
                        </div>
                        <div class="form-group">
                            <label>ƒê∆°n Gi√° *</label>
                            <input type="number" id="materialPrice" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë L∆∞·ª£ng T·ªìn Kho</label>
                            <input type="number" id="materialStock" value="0">
                        </div>
                        <div class="form-group">
                            <label>Nh√† Cung C·∫•p</label>
                            <select id="materialSupplier">
                                <option value="">Ch·ªçn nh√† cung c·∫•p</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ghi Ch√∫</label>
                        <textarea id="materialNote" rows="2"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Th√™m Nguy√™n V·∫≠t Li·ªáu</button>
                </form>
            </div>

            <div class="form-card">
                <h2>Nh·∫≠p Kho Nguy√™n V·∫≠t Li·ªáu</h2>
                <form id="materialImportForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>M√£ Phi·∫øu Nh·∫≠p *</label>
                            <input type="text" id="importCode" required>
                        </div>
                        <div class="form-group">
                            <label>Ng√†y Nh·∫≠p *</label>
                            <input type="date" id="importDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nguy√™n V·∫≠t Li·ªáu *</label>
                            <select id="importMaterial" required>
                                <option value="">Ch·ªçn nguy√™n v·∫≠t li·ªáu</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>S·ªë L∆∞·ª£ng *</label>
                            <input type="number" id="importQuantity" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ƒê∆°n Gi√° *</label>
                            <input type="number" id="importPrice" required>
                        </div>
                        <div class="form-group">
                            <label>Th√†nh Ti·ªÅn</label>
                            <input type="number" id="importTotal" readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ghi Ch√∫</label>
                        <textarea id="importNote" rows="2"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">L∆∞u Phi·∫øu Nh·∫≠p</button>
                </form>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>Danh S√°ch Nguy√™n V·∫≠t Li·ªáu</h2>
                    <div>
                        <button onclick="exportInventoryReport()" class="btn-export" style="margin-right: 10px;">B√°o C√°o XNT</button>
                        <button onclick="exportMaterials()" class="btn-export">Xu·∫•t Excel</button>
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>M√£ NVL</th>
                            <th>T√™n NVL</th>
                            <th>ƒê∆°n V·ªã</th>
                            <th>ƒê∆°n Gi√°</th>
                            <th>T·ªìn Kho</th>
                            <th>Gi√° Tr·ªã T·ªìn</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="materialList"></tbody>
                </table>
            </div>

            <div class="form-card">
                <h2>Xu·∫•t Kho Nguy√™n V·∫≠t Li·ªáu</h2>
                <form id="materialExportForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>M√£ Phi·∫øu Xu·∫•t *</label>
                            <input type="text" id="exportCode" required>
                        </div>
                        <div class="form-group">
                            <label>Ng√†y Xu·∫•t *</label>
                            <input type="date" id="exportDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nguy√™n V·∫≠t Li·ªáu *</label>
                            <select id="exportMaterial" required>
                                <option value="">Ch·ªçn nguy√™n v·∫≠t li·ªáu</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>S·ªë L∆∞·ª£ng *</label>
                            <input type="number" id="exportQuantity" step="0.1" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>M·ª•c ƒê√≠ch Xu·∫•t *</label>
                            <select id="exportPurpose" required>
                                <option value="">Ch·ªçn m·ª•c ƒë√≠ch</option>
                                <option value="sale">B√°n cho kh√°ch h√†ng</option>
                                <option value="return">Ho√†n tr·∫£ nh√† cung c·∫•p</option>
                                <option value="internal">S·ª≠ d·ª•ng n·ªôi b·ªô</option>
                                <option value="production">S·∫£n xu·∫•t</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ƒê·ªëi T∆∞·ª£ng</label>
                            <select id="exportTarget">
                                <option value="">Ch·ªçn ƒë·ªëi t∆∞·ª£ng</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ƒê∆°n Gi√° Xu·∫•t</label>
                            <input type="number" id="exportPrice" readonly>
                        </div>
                        <div class="form-group">
                            <label>Th√†nh Ti·ªÅn</label>
                            <input type="number" id="exportTotal" readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ghi Ch√∫</label>
                        <textarea id="exportNote" rows="2"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">L∆∞u Phi·∫øu Xu·∫•t</button>
                </form>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>L·ªãch S·ª≠ Nh·∫≠p Kho</h2>
                    <button onclick="exportImports()" class="btn-export">Xu·∫•t Excel</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>M√£ Phi·∫øu</th>
                            <th>Ng√†y</th>
                            <th>Nguy√™n V·∫≠t Li·ªáu</th>
                            <th>S·ªë L∆∞·ª£ng</th>
                            <th>ƒê∆°n Gi√°</th>
                            <th>Th√†nh Ti·ªÅn</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="importList"></tbody>
                </table>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>L·ªãch S·ª≠ Xu·∫•t Kho</h2>
                    <button onclick="exportMaterialExports()" class="btn-export">Xu·∫•t Excel</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>M√£ Phi·∫øu</th>
                            <th>Ng√†y</th>
                            <th>Nguy√™n V·∫≠t Li·ªáu</th>
                            <th>S·ªë L∆∞·ª£ng</th>
                            <th>M·ª•c ƒê√≠ch</th>
                            <th>ƒê·ªëi T∆∞·ª£ng</th>
                            <th>Th√†nh Ti·ªÅn</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="exportList"></tbody>
                </table>
            </div>
        </div>

        <!-- S·ªë D∆∞ ƒê·∫ßu K·ª≥ -->
        <div id="opening" class="section">
            <h1>S·ªë D∆∞ ƒê·∫ßu K·ª≥</h1>
            
            <div class="form-card">
                <h2>Thi·∫øt L·∫≠p S·ªë D∆∞ ƒê·∫ßu K·ª≥</h2>
                <form id="openingBalanceForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>K·ª≥ K·∫ø To√°n *</label>
                            <input type="month" id="openingPeriod" required>
                        </div>
                        <div class="form-group">
                            <label>S·ªë D∆∞ Ti·ªÅn M·∫∑t *</label>
                            <input type="number" id="openingCash" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë D∆∞ Ng√¢n H√†ng</label>
                            <input type="number" id="openingBank" value="0">
                        </div>
                        <div class="form-group">
                            <label>T·ªïng S·ªë D∆∞</label>
                            <input type="number" id="openingTotal" readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ghi Ch√∫</label>
                        <textarea id="openingNote" rows="2"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">L∆∞u S·ªë D∆∞ ƒê·∫ßu K·ª≥</button>
                </form>
            </div>

            <div class="form-card">
                <h2>C√¥ng N·ª£ Ph·∫£i Thu ƒê·∫ßu K·ª≥</h2>
                <form id="receivableForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Kh√°ch H√†ng *</label>
                            <select id="receivableCustomer" required>
                                <option value="">Ch·ªçn kh√°ch h√†ng</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>S·ªë Ti·ªÅn N·ª£ *</label>
                            <input type="number" id="receivableAmount" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ghi Ch√∫</label>
                        <textarea id="receivableNote" rows="2"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Th√™m C√¥ng N·ª£ Ph·∫£i Thu</button>
                </form>

                <table style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th>Kh√°ch H√†ng</th>
                            <th>S·ªë Ti·ªÅn N·ª£</th>
                            <th>Ghi Ch√∫</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="receivableList"></tbody>
                </table>
            </div>

            <div class="form-card">
                <h2>C√¥ng N·ª£ Ph·∫£i Tr·∫£ ƒê·∫ßu K·ª≥</h2>
                <form id="payableForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nh√† Cung C·∫•p *</label>
                            <select id="payableSupplier" required>
                                <option value="">Ch·ªçn nh√† cung c·∫•p</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>S·ªë Ti·ªÅn N·ª£ *</label>
                            <input type="number" id="payableAmount" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ghi Ch√∫</label>
                        <textarea id="payableNote" rows="2"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Th√™m C√¥ng N·ª£ Ph·∫£i Tr·∫£</button>
                </form>

                <table style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th>Nh√† Cung C·∫•p</th>
                            <th>S·ªë Ti·ªÅn N·ª£</th>
                            <th>Ghi Ch√∫</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="payableList"></tbody>
                </table>
            </div>

            <div class="data-table">
                <h2>T·ªïng H·ª£p S·ªë D∆∞ ƒê·∫ßu K·ª≥</h2>
                <div class="report-summary">
                    <div class="summary-card">
                        <h3>Ti·ªÅn M·∫∑t + Ng√¢n H√†ng</h3>
                        <p id="summaryBalance" class="amount-positive">0 ƒë</p>
                    </div>
                    <div class="summary-card">
                        <h3>C√¥ng N·ª£ Ph·∫£i Thu</h3>
                        <p id="summaryReceivable" class="amount-positive">0 ƒë</p>
                    </div>
                    <div class="summary-card">
                        <h3>C√¥ng N·ª£ Ph·∫£i Tr·∫£</h3>
                        <p id="summaryPayable" class="amount-negative">0 ƒë</p>
                    </div>
                    <div class="summary-card">
                        <h3>T·ªïng T√†i S·∫£n</h3>
                        <p id="summaryTotal">0 ƒë</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Nh√¢n Vi√™n -->
        <div id="employee" class="section">
            <h1>Qu·∫£n L√Ω Nh√¢n Vi√™n</h1>
            <div class="form-card">
                <form id="employeeForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>M√£ Nh√¢n Vi√™n *</label>
                            <input type="text" id="empCode" required>
                        </div>
                        <div class="form-group">
                            <label>H·ªç T√™n *</label>
                            <input type="text" id="empName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë ƒêi·ªán Tho·∫°i</label>
                            <input type="tel" id="empPhone">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="empEmail">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ch·ª©c V·ª• *</label>
                            <input type="text" id="empPosition" required>
                        </div>
                        <div class="form-group">
                            <label>Ph√≤ng Ban</label>
                            <input type="text" id="empDepartment">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>L∆∞∆°ng C∆° B·∫£n *</label>
                            <input type="number" id="empBaseSalary" required>
                        </div>
                        <div class="form-group">
                            <label>V√πng L∆∞∆°ng *</label>
                            <select id="empRegion" required>
                                <option value="region1">V√πng I (4,960,000ƒë)</option>
                                <option value="region2">V√πng II (4,410,000ƒë)</option>
                                <option value="region3">V√πng III (3,860,000ƒë)</option>
                                <option value="region4">V√πng IV (3,450,000ƒë)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë Ng∆∞·ªùi Ph·ª• Thu·ªôc</label>
                            <input type="number" id="empDependents" value="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>Ng√†y V√†o L√†m</label>
                            <input type="date" id="empStartDate">
                        </div>
                    </div>
                    <button type="submit" class="btn-primary">Th√™m Nh√¢n Vi√™n</button>
                </form>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>Danh S√°ch Nh√¢n Vi√™n</h2>
                    <button onclick="exportEmployees()" class="btn-export">Xu·∫•t Excel</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>M√£ NV</th>
                            <th>H·ªç T√™n</th>
                            <th>Ch·ª©c V·ª•</th>
                            <th>Ph√≤ng Ban</th>
                            <th>L∆∞∆°ng CB</th>
                            <th>V√πng</th>
                            <th>NPT</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="employeeList"></tbody>
                </table>
            </div>
        </div>

        <!-- Ch·∫•m C√¥ng -->
        <div id="attendance" class="section">
            <h1>Ch·∫•m C√¥ng & T√≠nh L∆∞∆°ng</h1>
            
            <div class="form-card">
                <h2>Ch·∫•m C√¥ng Theo Th√°ng</h2>
                <form id="attendanceForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nh√¢n Vi√™n *</label>
                            <select id="attEmployee" required>
                                <option value="">Ch·ªçn nh√¢n vi√™n</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Th√°ng *</label>
                            <input type="month" id="attMonth" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë Ng√†y C√¥ng *</label>
                            <input type="number" id="attWorkDays" step="0.5" min="0" max="31" required>
                        </div>
                        <div class="form-group">
                            <label>S·ªë Gi·ªù TƒÉng Ca</label>
                            <input type="number" id="attOvertimeHours" step="0.5" min="0" value="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ph·ª• C·∫•p</label>
                            <input type="number" id="attAllowance" value="0">
                        </div>
                        <div class="form-group">
                            <label>Th∆∞·ªüng</label>
                            <input type="number" id="attBonus" value="0">
                        </div>
                    </div>
                    <button type="submit" class="btn-primary">T√≠nh L∆∞∆°ng</button>
                </form>
            </div>

            <div class="salary-preview form-card" id="salaryPreview" style="display: none;">
                <h2>Chi Ti·∫øt L∆∞∆°ng</h2>
                <div class="salary-details">
                    <div class="salary-row">
                        <span>L∆∞∆°ng C∆° B·∫£n:</span>
                        <strong id="previewBaseSalary">0 ƒë</strong>
                    </div>
                    <div class="salary-row">
                        <span>L∆∞∆°ng Theo Ng√†y C√¥ng:</span>
                        <strong id="previewWorkSalary">0 ƒë</strong>
                    </div>
                    <div class="salary-row">
                        <span>L∆∞∆°ng TƒÉng Ca:</span>
                        <strong id="previewOvertimeSalary">0 ƒë</strong>
                    </div>
                    <div class="salary-row">
                        <span>Ph·ª• C·∫•p:</span>
                        <strong id="previewAllowance">0 ƒë</strong>
                    </div>
                    <div class="salary-row">
                        <span>Th∆∞·ªüng:</span>
                        <strong id="previewBonus">0 ƒë</strong>
                    </div>
                    <div class="salary-row total">
                        <span>T·ªïng Thu Nh·∫≠p:</span>
                        <strong id="previewGrossIncome">0 ƒë</strong>
                    </div>
                    <hr>
                    <div class="salary-row deduction">
                        <span>BHXH (8%):</span>
                        <strong id="previewBHXH">0 ƒë</strong>
                    </div>
                    <div class="salary-row deduction">
                        <span>BHYT (1.5%):</span>
                        <strong id="previewBHYT">0 ƒë</strong>
                    </div>
                    <div class="salary-row deduction">
                        <span>BHTN (1%):</span>
                        <strong id="previewBHTN">0 ƒë</strong>
                    </div>
                    <div class="salary-row deduction">
                        <span>T·ªïng BH (10.5%):</span>
                        <strong id="previewTotalInsurance">0 ƒë</strong>
                    </div>
                    <hr>
                    <div class="salary-row">
                        <span>Thu Nh·∫≠p Tr∆∞·ªõc Thu·∫ø:</span>
                        <strong id="previewTaxableIncome">0 ƒë</strong>
                    </div>
                    <div class="salary-row">
                        <span>Gi·∫£m Tr·ª´ B·∫£n Th√¢n:</span>
                        <strong id="previewSelfDeduction">11,000,000 ƒë</strong>
                    </div>
                    <div class="salary-row">
                        <span>Gi·∫£m Tr·ª´ Ng∆∞·ªùi PT:</span>
                        <strong id="previewDependentDeduction">0 ƒë</strong>
                    </div>
                    <div class="salary-row">
                        <span>Thu Nh·∫≠p T√≠nh Thu·∫ø:</span>
                        <strong id="previewTaxBase">0 ƒë</strong>
                    </div>
                    <div class="salary-row deduction">
                        <span>Thu·∫ø TNCN:</span>
                        <strong id="previewTax">0 ƒë</strong>
                    </div>
                    <hr>
                    <div class="salary-row net">
                        <span>L∆Ø∆†NG TH·ª∞C Lƒ®NH:</span>
                        <strong id="previewNetSalary">0 ƒë</strong>
                    </div>
                </div>
                <button onclick="saveAttendance()" class="btn-primary">L∆∞u B·∫£ng L∆∞∆°ng</button>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>B·∫£ng L∆∞∆°ng Th√°ng</h2>
                    <div>
                        <button onclick="sendReportByEmail('salaries')" class="btn-export" style="background: #3498db; margin-right: 10px;">üìß G·ª≠i Email</button>
                        <button onclick="exportSalaries()" class="btn-export">Xu·∫•t Excel</button>
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Th√°ng</th>
                            <th>Nh√¢n Vi√™n</th>
                            <th>Ng√†y C√¥ng</th>
                            <th>T·ªïng Thu</th>
                            <th>B·∫£o Hi·ªÉm</th>
                            <th>Thu·∫ø TNCN</th>
                            <th>Th·ª±c Lƒ©nh</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="attendanceList"></tbody>
                </table>
            </div>
        </div>

        <!-- H·∫°ch To√°n -->
        <div id="accounting" class="section">
            <h1>H·∫°ch To√°n K·∫ø To√°n</h1>
            
            <div class="form-card">
                <h2>T·∫°o B√∫t To√°n</h2>
                <form id="accountingForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë Ch·ª©ng T·ª´ *</label>
                            <input type="text" id="accVoucherNo" required>
                        </div>
                        <div class="form-group">
                            <label>Ng√†y Ch·ª©ng T·ª´ *</label>
                            <input type="date" id="accDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>T√†i Kho·∫£n N·ª£ *</label>
                            <select id="accDebit" required></select>
                        </div>
                        <div class="form-group">
                            <label>T√†i Kho·∫£n C√≥ *</label>
                            <select id="accCredit" required></select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>S·ªë Ti·ªÅn *</label>
                            <input type="number" id="accAmount" required>
                        </div>
                        <div class="form-group">
                            <label>Lo·∫°i Ch·ª©ng T·ª´</label>
                            <select id="accType">
                                <option value="manual">Nh·∫≠p tay</option>
                                <option value="receipt">Phi·∫øu thu</option>
                                <option value="payment">Phi·∫øu chi</option>
                                <option value="invoice">H√≥a ƒë∆°n</option>
                                <option value="salary">B·∫£ng l∆∞∆°ng</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Di·ªÖn Gi·∫£i</label>
                        <textarea id="accDescription" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Ghi S·ªï</button>
                </form>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>S·ªï Nh·∫≠t K√Ω Chung</h2>
                    <div>
                        <button onclick="sendReportByEmail('accounting')" class="btn-export" style="background: #3498db; margin-right: 10px;">üìß G·ª≠i Email</button>
                        <button onclick="exportAccounting()" class="btn-export">Xu·∫•t Excel</button>
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Ng√†y</th>
                            <th>S·ªë CT</th>
                            <th>Di·ªÖn Gi·∫£i</th>
                            <th>TK N·ª£</th>
                            <th>TK C√≥</th>
                            <th>S·ªë Ti·ªÅn</th>
                            <th>Lo·∫°i</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="accountingList"></tbody>
                </table>
            </div>

            <div class="form-card">
                <h2>B√°o C√°o T√†i Kho·∫£n</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ch·ªçn T√†i Kho·∫£n</label>
                        <select id="reportAccount"></select>
                    </div>
                    <button onclick="generateAccountReport()" class="btn-primary">Xem B√°o C√°o</button>
                </div>
                <div id="accountReport" class="account-report" style="display: none;">
                    <h3>S·ªï C√°i T√†i Kho·∫£n <span id="reportAccountName"></span></h3>
                    <div class="account-summary">
                        <div class="summary-item">
                            <span>T·ªïng N·ª£:</span>
                            <strong id="reportTotalDebit">0 ƒë</strong>
                        </div>
                        <div class="summary-item">
                            <span>T·ªïng C√≥:</span>
                            <strong id="reportTotalCredit">0 ƒë</strong>
                        </div>
                        <div class="summary-item">
                            <span>S·ªë D∆∞:</span>
                            <strong id="reportBalance">0 ƒë</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- C√†i ƒê·∫∑t -->
        <div id="settings" class="section">
            <h1>C√†i ƒê·∫∑t H·ªá Th·ªëng</h1>
            
            <div class="form-card">
                <h2>üîÑ Sao L∆∞u & Kh√¥i Ph·ª•c D·ªØ Li·ªáu</h2>
                <div class="settings-actions">
                    <button onclick="backupData()" class="btn-backup">
                        üíæ Sao L∆∞u D·ªØ Li·ªáu
                    </button>
                    <button onclick="document.getElementById('restoreFile').click()" class="btn-restore">e
                        üì• Kh√¥i Ph·ª•c D·ªØ Li·ªáu
                    </button>
                    <input type="file" id="restoreFile" accept=".json" style="display: none;" onchange="restoreData(event)">
                </div>
                <p class="settings-note">üí° Sao l∆∞u d·ªØ li·ªáu tr∆∞·ªõc khi reset ƒë·ªÉ tr√°nh m·∫•t d·ªØ li·ªáu quan tr·ªçng</p>
            </div>

            <div class="form-card">
                <h2>üóëÔ∏è X√≥a D·ªØ Li·ªáu</h2>
                <div class="reset-options">
                    <div class="reset-item">
                        <h3>X√≥a Giao D·ªãch</h3>
                        <p>X√≥a phi·∫øu thu, phi·∫øu chi, h√≥a ƒë∆°n (gi·ªØ l·∫°i kh√°ch h√†ng, NCC, NVL)</p>
                        <button onclick="resetTransactions()" class="btn-warning">X√≥a Giao D·ªãch</button>
                    </div>
                    <div class="reset-item">
                        <h3>X√≥a T·∫•t C·∫£ D·ªØ Li·ªáu</h3>
                        <p>X√≥a to√†n b·ªô d·ªØ li·ªáu trong h·ªá th·ªëng (backup t·ª± ƒë·ªông)</p>
                        <button onclick="resetAllData()" class="btn-danger">X√≥a T·∫•t C·∫£</button>
                    </div>
                </div>
            </div>

            <div class="form-card">
                <h2>üìß C·∫•u H√¨nh Email</h2>
                <p style="color: #666; margin-bottom: 15px;">
                    C·∫•u h√¨nh ƒë·ªÉ g·ª≠i b√°o c√°o qua email. ƒêƒÉng k√Ω mi·ªÖn ph√≠ t·∫°i 
                    <a href="https://www.emailjs.com/" target="_blank" style="color: #3498db;">EmailJS.com</a>
                </p>
                <button onclick="showEmailConfigForm()" class="btn-primary">
                    ‚öôÔ∏è C·∫•u H√¨nh Email
                </button>
                <p style="margin-top: 10px; font-size: 0.9em; color: #7f8c8d;">
                    Tr·∫°ng th√°i: <strong id="emailStatus" style="color: #e74c3c;">Ch∆∞a c·∫•u h√¨nh</strong>
                </p>
            </div>

            <div class="form-card">
                <h2>üìä Th√¥ng Tin H·ªá Th·ªëng</h2>
                <div class="system-info">
                    <div class="info-row">
                        <span>Kh√°ch H√†ng:</span>
                        <strong id="infoCustomers">0</strong>
                    </div>
                    <div class="info-row">
                        <span>Nh√† Cung C·∫•p:</span>
                        <strong id="infoSuppliers">0</strong>
                    </div>
                    <div class="info-row">
                        <span>Phi·∫øu Thu:</span>
                        <strong id="infoReceipts">0</strong>
                    </div>
                    <div class="info-row">
                        <span>Phi·∫øu Chi:</span>
                        <strong id="infoPayments">0</strong>
                    </div>
                    <div class="info-row">
                        <span>H√≥a ƒê∆°n:</span>
                        <strong id="infoInvoices">0</strong>
                    </div>
                    <div class="info-row">
                        <span>Nguy√™n V·∫≠t Li·ªáu:</span>
                        <strong id="infoMaterials">0</strong>
                    </div>
                    <div class="info-row">
                        <span>Phi·∫øu Nh·∫≠p Kho:</span>
                        <strong id="infoImports">0</strong>
                    </div>
                </div>
                <button onclick="updateSystemInfo()" class="btn-primary" style="margin-top: 15px;">
                    üîÑ C·∫≠p Nh·∫≠t Th√¥ng Tin
                </button>
            </div>
        </div>

        <!-- B√°o C√°o -->
        <div id="report" class="section">
            <h1>B√°o C√°o T√†i Ch√≠nh</h1>
            
            <div class="report-filter">
                <div class="form-row">
                    <div class="form-group">
                        <label>T·ª´ Ng√†y</label>
                        <input type="date" id="reportStartDate">
                    </div>
                    <div class="form-group">
                        <label>ƒê·∫øn Ng√†y</label>
                        <input type="date" id="reportEndDate">
                    </div>
                    <button onclick="generateReport()" class="btn-primary">T·∫°o B√°o C√°o</button>
                </div>
            </div>

            <div class="report-summary">
                <div class="summary-card">
                    <h3>T·ªïng Thu</h3>
                    <p id="reportRevenue" class="amount-positive">0 ƒë</p>
                </div>
                <div class="summary-card">
                    <h3>T·ªïng Chi</h3>
                    <p id="reportExpense" class="amount-negative">0 ƒë</p>
                </div>
                <div class="summary-card">
                    <h3>L·ª£i Nhu·∫≠n</h3>
                    <p id="reportProfit">0 ƒë</p>
                </div>
            </div>

            <div class="data-table">
                <div class="table-header">
                    <h2>Chi Ti·∫øt Giao D·ªãch</h2>
                    <button onclick="exportReport()" class="btn-export">Xu·∫•t Excel</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Ng√†y</th>
                            <th>Lo·∫°i</th>
                            <th>M√£</th>
                            <th>ƒê·ªëi T∆∞·ª£ng</th>
                            <th>Thu</th>
                            <th>Chi</th>
                            <th>Di·ªÖn Gi·∫£i</th>
                        </tr>
                    </thead>
                    <tbody id="reportDetails"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="chart-of-accounts.js"></script>
    <script src="script.js"></script>
    <script src="payroll-accounting.js"></script>
    <script src="material-export.js"></script>
    <script src="email-service.js"></script>
    <script src="table-wrapper.js"></script>
</body>
</html>
